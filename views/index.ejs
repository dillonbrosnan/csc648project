<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" dir="ltr">

<head>
  <% include partials/head %>
  <link rel="stylesheet" href="css/index.css"></link>
</head>

<body>

  <% include partials/header %>

<<<<<<< HEAD
  <div class="container">
  <div class="jumbotron">
    <h1Team 07</h1> 
    <p>Click on portfolio in the navbar to see our team</p> 
    </div>
    </div>
=======
    <section class="container">
  <!-- search component -->
    <div class="left-half">
    <article>
    <section class="leftHandSide">
    <input type="textarea" name="query" id="query">
    <input type="button" name="submit" onclick="createMarkers()" value="Look for address">
    <div id="map"></div>
    <script>
    
    var map;
    var startLatLng = {lat: 37.7749, lng: -122.4194};
    var markers = [];
    var listingObjects = []; 
    var query;

    function initMap() {
      map = new google.maps.Map(document.getElementById('map'), {
        center: startLatLng,
        zoom: 11
      });
    }

    function createMarkers(){
      var data = <%- JSON.stringify(data) %>
      //console.log(data);
      query = document.getElementById("query").value;
      var infowindow = new google.maps.InfoWindow();
      if(listingObjects.length){
        listingObjects = []; 
      }
      while(markers.length > 0){
        markers[markers.length-1].setMap(null);
        markers.pop();
      }
      for(let i = 0; i < data.length; i++){
        if(data[i].city.toLowerCase() == query){
          let lat1 = parseFloat(data[i].lat);
          let lng1 = parseFloat(data[i].lon);
          var myLatLng={lat: lat1, lng: lng1};
          listingObjects.push(data[i]);
          marker = new google.maps.Marker({
            map: map,
            position: myLatLng,
            title: data[i].streetNumber + ' ' + data[i].streetName
          });
          markers.push(marker);
          google.maps.event.addListener(marker, 'click', function(){
            infowindow.setContent('<div onclick="getInfo(this.innerHTML)">' +  data[i].streetNumber + ' ' + data[i].streetName + '</div>');
            infowindow.open(map,this);
          }); 
        }
      }
      createTable();
    }

// function createInfoBox(jsonListing){
//   //getting parent element to append child elements into it
//     let parent = document.getElementsByClassName('row text-center')[0]; 
    
//     //check parent children nodes to clear the right side out
//     while(parent.hasChildNodes()){
//         parent.removeChild(parent.lastChild); 

//     }
//      parent.lastChild = ''; 

//     for(let i = 0; i < jsonListing.length; i++){

//         //getting data from objects 
//         let city    = jsonListing[i].city, 
//             price   = jsonListing[i].price, 
//             address = jsonListing[i].address, 
//             zipcode = jsonListing[i].zipcode; 

//             //creating elements 
//         let div       = document.createElement('DIV'), 
//             childDiv  = document.createElement('DIV'), 
//             aTag      = document.createElement("A"),
//             img       = document.createElement('IMG'), 
//             pTag      = document.createElement('P'), 
//             strongTag = document.createElement('STRONG'), 
//             pTagg     = document.createElement('P'); 

            
//         div.className       = "col-sm-4", 
//         childDiv.className  = "thumbnail", 
//         img.alt             = i, 
//         img.src             ="image.png", 
//         img.width           = '900', 
//         img.height          = "300", 
//         aTag.src            = "#"; 

//         //console.log(parent)
//         parent.appendChild(div),
//         div.appendChild(childDiv); 
//         childDiv.appendChild(aTag); 
//         aTag.appendChild(img); 
//         childDiv.appendChild(pTag);
//         pTag.appendChild(strongTag);
//         pTag.appendChild(pTagg); 
//         childDiv.appendChild(pTagg); 

//         var priceNode   = document.createTextNode(price); 
//         strongTag.appendChild(priceNode); 

//         var addressNode = document.createTextNode(address); 
//         pTagg.appendChild(addressNode); 
//     }
// }

    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBPXF-zkLqKND8w5ktBN5bdlTkQSVbw950&callback=initMap"
    async defer></script>
  </section>
      </article>
  </div>
  <!--end of result section -->
  <!--result section -->
    <div class="right-half">
      <article>
        <h1>Right Half</h1>
<!--         <div class="row text-center">
          <table class="table table-bordered"> -->
            <table id = "displayTable">
            <thead>
              <tr>
                <td>Street Number</td>
                <td>Street Name</td>
                <td>City</td>
                <td>Zip Code</td>
                <td>Price</td>
                <td>Image</td>
              </tr>
            </thead>
          </table>
            <script type="text/javascript">
              function createTable(){
                var data = <%- JSON.stringify(data) %>
                var table = document.getElementById("displayTable");
                while(table.rows.length > 1){
                  console.log(table.rows.length);
                  table.deleteRow(table.rows.length-1);
                }
                for(let i = 0; i < data.length; i++){
                  if(data[i].city.toLowerCase() == query){
                    var row = table.insertRow(table.length);
                    var c0 = row.insertCell(0);
                    var c1 = row.insertCell(1);
                    var c2 = row.insertCell(2);
                    var c3 = row.insertCell(3);
                    var c4 = row.insertCell(4);
                    var c5 = row.insertCell(5)
                    var address = data[i].streetNumber;
                    var street = data[i].streetName;
                    var city = data[i].city;
                    var zip = data[i].postalCode;
                    var price = data[i].price;
                    c0.innerHTML = address;
                    c1.innerHTML = street;
                    c2.innerHTML = city;
                    c3.innerHTML = zip;
                    c4.innerHTML = price

                    var suffix = data[i].imageId.toString();
                    var src = 'saleImages/' + suffix + '.jpg';
                    var img = document.createElement("IMG");
                    img.src = src;
                    img.style.width = "100px";
                    c5.appendChild(img);
                  }
                }
              }
            </script>
          </table>
      </article>
    </div>

  <!--end of result section -->

</section>
>>>>>>> dev

  <hr>

    <footer>
      <% include partials/footer %>
    </footer>
  </div> <!-- /container -->

  <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
</body>
</html>